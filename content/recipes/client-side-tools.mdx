---
title: Client-Side Tools
description: Let your AI avatar trigger actions in your application like navigation, modals, and UI updates.
tags: [tools, javascript, turnkey]
difficulty: intermediate
sdk: javascript
date: 2025-01-19
author: Anam Team
---

# Client-Side Tools

This recipe shows you how to use client tools to let your AI avatar control your application's UI. When a user asks to navigate somewhere, open a modal, or perform an action, the avatar can trigger it directly.

## How It Works

Client tools enable your persona to trigger actions in your frontend:

1. User makes a request ("Show me the pricing page")
2. LLM recognizes the intent and invokes the appropriate tool
3. Anam SDK emits a `CLIENT_TOOL_EVENT_RECEIVED` event
4. Your event handler executes the action (navigates to /pricing)
5. Avatar continues the conversation naturally

```
User: "I'd like to see your pricing"
Avatar: "Of course! Let me take you to our pricing page."
→ App navigates to /pricing
```

<Info>
Tool calling is currently in beta. The API may change as we continue to improve the feature.
</Info>

## Prerequisites

- Anam account with API key
- A persona configured with tools
- JavaScript SDK installed (`@anam-ai/js-sdk`)

## Step 1: Define Your Tools

Each client tool needs a schema that tells the LLM when and how to use it:

```typescript
const tools = [
  {
    type: 'client',
    name: 'navigate_to_page',
    description: 'Navigate to a specific page when the user asks to see pricing, features, documentation, or wants to go to a different section of the site.',
    parameters: {
      type: 'object',
      properties: {
        page: {
          type: 'string',
          description: 'The page to navigate to',
          enum: ['pricing', 'features', 'docs', 'contact', 'home'],
        },
      },
      required: ['page'],
    },
  },
  {
    type: 'client',
    name: 'open_modal',
    description: 'Open a modal dialog when the user wants to sign up, log in, start a trial, or view more details about something.',
    parameters: {
      type: 'object',
      properties: {
        modalType: {
          type: 'string',
          description: 'The type of modal to open',
          enum: ['signup', 'login', 'trial', 'details'],
        },
      },
      required: ['modalType'],
    },
  },
];
```

<Tip>
Use `enum` to constrain parameter values. This prevents the LLM from generating invalid options and makes your handler code simpler.
</Tip>

## Step 2: Create a Session with Tools

Include the tools when creating your session token:

```typescript
// server.ts
const response = await fetch('https://api.anam.ai/v1/auth/session-token', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${process.env.ANAM_API_KEY}`,
  },
  body: JSON.stringify({
    persona_id: 'your-persona-id',
    tools: tools,
  }),
});

const { session_token } = await response.json();
```

Alternatively, you can attach tools to your persona in Anam Lab for reuse across sessions.

## Step 3: Listen for Tool Events

Set up an event listener to handle tool invocations:

```typescript
import { AnamClient, AnamEvent } from '@anam-ai/js-sdk';

const client = new AnamClient({
  sessionToken: sessionToken,
});

// Listen for client tool events
client.addListener(AnamEvent.CLIENT_TOOL_EVENT_RECEIVED, (event) => {
  const { eventName, eventData } = event;

  switch (eventName) {
    case 'navigate_to_page':
      handleNavigation(eventData.page);
      break;

    case 'open_modal':
      handleModal(eventData.modalType);
      break;

    default:
      console.warn('Unknown tool event:', eventName);
  }
});

await client.streamToVideoElement('avatar-video');
```

## Step 4: Implement Tool Handlers

Create handlers for each tool action:

```typescript
// Valid pages whitelist
const validPages = ['pricing', 'features', 'docs', 'contact', 'home'];

function handleNavigation(page: string) {
  // Validate the page parameter
  if (!validPages.includes(page)) {
    console.error('Invalid page:', page);
    return;
  }

  // Navigate to the page
  window.location.href = `/${page}`;
}

function handleModal(modalType: string) {
  switch (modalType) {
    case 'signup':
      showSignupModal();
      break;
    case 'login':
      showLoginModal();
      break;
    case 'trial':
      showTrialModal();
      break;
    case 'details':
      showDetailsModal();
      break;
    default:
      console.error('Unknown modal type:', modalType);
  }
}
```

<Warning>
Always validate incoming parameters against a whitelist. Never trust tool parameters blindly—the LLM might generate unexpected values.
</Warning>

## Complete Example

Here's a full implementation for an e-commerce site:

```typescript
import { AnamClient, AnamEvent } from '@anam-ai/js-sdk';

// Define tools for an e-commerce assistant
const ecommerceTools = [
  {
    type: 'client',
    name: 'navigate_to_page',
    description: 'Navigate when user wants to browse products, view cart, see orders, or go to checkout.',
    parameters: {
      type: 'object',
      properties: {
        page: {
          type: 'string',
          enum: ['products', 'cart', 'orders', 'checkout', 'account'],
        },
      },
      required: ['page'],
    },
  },
  {
    type: 'client',
    name: 'filter_products',
    description: 'Apply filters when user wants to see specific product categories or price ranges.',
    parameters: {
      type: 'object',
      properties: {
        category: {
          type: 'string',
          enum: ['electronics', 'clothing', 'home', 'sports'],
        },
        maxPrice: {
          type: 'number',
          description: 'Maximum price filter',
        },
      },
      required: ['category'],
    },
  },
  {
    type: 'client',
    name: 'add_to_cart',
    description: 'Add a product to cart when user explicitly says they want to buy or add something.',
    parameters: {
      type: 'object',
      properties: {
        productId: {
          type: 'string',
          description: 'The ID of the product to add',
        },
        quantity: {
          type: 'number',
          description: 'Number of items to add',
        },
      },
      required: ['productId'],
    },
  },
];

async function initializeAssistant() {
  // Get session token with tools
  const res = await fetch('/api/session-token', {
    method: 'POST',
    body: JSON.stringify({ tools: ecommerceTools }),
  });
  const { session_token } = await res.json();

  // Initialize client
  const client = new AnamClient({ sessionToken: session_token });

  // Handle tool events
  client.addListener(AnamEvent.CLIENT_TOOL_EVENT_RECEIVED, (event) => {
    const { eventName, eventData } = event;

    try {
      switch (eventName) {
        case 'navigate_to_page':
          window.location.href = `/${eventData.page}`;
          break;

        case 'filter_products':
          applyFilters({
            category: eventData.category,
            maxPrice: eventData.maxPrice,
          });
          break;

        case 'add_to_cart':
          addToCart(eventData.productId, eventData.quantity || 1);
          break;
      }
    } catch (error) {
      console.error('Tool execution failed:', error);
    }
  });

  // Start streaming
  await client.streamToVideoElement('avatar-video');
}

initializeAssistant();
```

## Writing Good Tool Descriptions

The description is critical—it tells the LLM when to use each tool. Be specific:

```typescript
// Bad - too vague
description: 'Navigate to a page'

// Good - specific triggers
description: 'Navigate to a page when the user explicitly asks to see pricing, wants to view features, needs documentation, or asks to go somewhere specific on the site.'
```

```typescript
// Bad - unclear intent
description: 'Open a modal'

// Good - clear triggers
description: 'Open the checkout modal only when the user explicitly says they want to purchase, buy, complete their order, or proceed to checkout.'
```

## Security Best Practices

### Validate All Parameters

```typescript
client.addListener(AnamEvent.CLIENT_TOOL_EVENT_RECEIVED, (event) => {
  const { eventName, eventData } = event;

  // Whitelist of allowed values
  const allowedPages = ['home', 'pricing', 'docs'];

  if (eventName === 'navigate_to_page') {
    if (!allowedPages.includes(eventData.page)) {
      console.error('Invalid navigation target');
      return;
    }
    // Safe to navigate
  }
});
```

### Never Pass Sensitive Data

```typescript
// Bad - exposes sensitive data
{
  name: 'process_payment',
  parameters: {
    properties: {
      cardNumber: { type: 'string' }, // Never do this!
    },
  },
}

// Good - use IDs, fetch sensitive data server-side
{
  name: 'process_payment',
  parameters: {
    properties: {
      paymentMethodId: { type: 'string' }, // Reference only
    },
  },
}
```

### Implement Rate Limiting

```typescript
let toolCallCount = 0;
const MAX_CALLS_PER_MINUTE = 20;

client.addListener(AnamEvent.CLIENT_TOOL_EVENT_RECEIVED, (event) => {
  toolCallCount++;

  if (toolCallCount > MAX_CALLS_PER_MINUTE) {
    console.warn('Rate limit exceeded');
    return;
  }

  // Handle tool event...
});

// Reset counter every minute
setInterval(() => {
  toolCallCount = 0;
}, 60000);
```

## Troubleshooting

**Tool not being called:**
- Check that the tool description clearly explains when to use it
- Verify tools are included in the session token
- Test with explicit phrases like "navigate to pricing"

**Wrong tool parameters:**
- Use `enum` to constrain values
- Make parameter descriptions more specific
- Add examples to your system prompt

**Events not firing:**
- Ensure event listener is added before `streamToVideoElement`
- Check browser console for errors
- Verify WebSocket connection is established

## Next Steps

- [RAG Knowledge Base](/rag-knowledge-base) - Add knowledge tools for document search
- [Bring Your Own LLM](/byo-llm-integration) - Implement tools with your own LLM
- [Anam Lab Tools](https://lab.anam.ai) - Create and manage tools in the dashboard
